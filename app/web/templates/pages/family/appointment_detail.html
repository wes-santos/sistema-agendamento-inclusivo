{# web/templates/pages/family/appointment_detail.html #}
{% extends "_base/base.html" %}
{% set body_class = 'page-family page-family-appointment-detail' %}
{% from "components/card.html" import card %}
{% from "components/badge.html" import status_badge %}

{% block title %}Agendamento — Detalhes{% endblock %}

{% block extra_css %}
<style>
  .dl.grid-2 {display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1rem}
  .dl dt {font-weight:600;color:var(--muted);margin:0 0 .25rem}
  .dl dd {margin:0}
  .detail-head {display:flex;align-items:center;justify-content:space-between;gap:.75rem;margin-bottom:.5rem}
  .detail-title {font-size:1.1rem;font-weight:700}
  .detail-sub {color:var(--muted)}
  .btnbar {display:flex;gap:.5rem;flex-wrap:wrap}
  .mt-4{margin-top:1rem}
  .hstack{display:flex;gap:.5rem;align-items:center}
  .only-desktop{display:none}@media(min-width:768px){.only-desktop{display:flex}}
  .only-mobile{display:flex}@media(min-width:768px){.only-mobile{display:none}}
  
  /* Improved appointment details styling */
  .appointment-header {
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--border);
    margin-bottom: 1.5rem;
  }
  
  .appointment-title {
    font-size: 1.5rem;
    font-weight: 700;
    margin: 0 0 0.25rem;
  }
  
  .appointment-subtitle {
    font-size: 1.1rem;
    color: var(--muted);
    margin: 0 0 0.5rem;
  }
  
  .appointment-meta {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    font-size: 0.9rem;
  }
  
  .meta-item {
    display: flex;
    align-items: center;
    gap: 0.25rem;
  }
  
  .status-section {
    margin: 1.5rem 0;
    padding: 1rem;
    background: var(--surface-1);
    border-radius: var(--radius-sm);
    border: 1px solid var(--border);
  }
  
  .status-label {
    font-weight: 600;
    margin: 0 0 0.25rem;
  }
  
  .action-buttons {
    margin-top: 1.5rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--border);
  }
</style>
{% endblock %}

{% block content %}
{% set breadcrumbs = [{'label':'Família', 'href':'/family/appointments'}, {'label':'Detalhes'}] %}
{% include "_partials/breadcrumbs.html" %}

{% set header_actions %}
<div class="btnbar only-desktop">
  <a class="btn btn--ghost" href="/family/dashboard">Voltar ao painel</a>
  <a class="btn btn--ghost" href="/family/appointments">Voltar aos agendamentos</a>
  {% if appointment.confirm_url %}<a class="btn btn--success" href="{{ appointment.confirm_url }}">Confirmar presença</a>{% endif %}
  {% if appointment.cancel_url %}<a class="btn btn--danger" href="{{ appointment.cancel_url }}">Cancelar</a>{% endif %}
</div>
{% endset %}

{% call card() %}
<div class="appointment-header">
  <h1 class="appointment-title">{{ appointment.service_name }}</h1>
  <h2 class="appointment-subtitle">{{ appointment.professional_name }}</h2>
  
  <div class="appointment-meta">
    <div class="meta-item">
      <span>Início:</span>
      <strong>{{ appointment.starts_at_local }}</strong>
    </div>
    {% if appointment.ends_at_local %}
    <div class="meta-item">
      <span>Fim:</span>
      <strong>{{ appointment.ends_at_local }}</strong>
    </div>
    {% endif %}
    {% if appointment.location %}
    <div class="meta-item">
      <span>Local:</span>
      <strong>{{ appointment.location }}</strong>
    </div>
    {% endif %}
  </div>
</div>

<div class="status-section">
  <div class="status-label">Status do agendamento</div>
  <div>{{ status_badge(appointment.status) }}</div>
</div>

<div class="action-buttons">
  <div class="btnbar only-mobile">
    <a class="btn btn--ghost" href="/family/dashboard">Voltar ao painel</a>
    <a class="btn btn--ghost" href="/family/appointments">Voltar aos agendamentos</a>
    {% if appointment.confirm_url %}<a class="btn btn--success" href="{{ appointment.confirm_url }}">Confirmar presença</a>{% endif %}
    {% if appointment.cancel_url %}<a class="btn btn--danger" href="{{ appointment.cancel_url }}">Cancelar</a>{% endif %}
  </div>
  
  <div class="btnbar only-desktop" style="margin-top: 1rem;">
    {% if appointment.confirm_url %}<a class="btn btn--success" href="{{ appointment.confirm_url }}">Confirmar presença</a>{% endif %}
    {% if appointment.cancel_url %}<a class="btn btn--danger" href="{{ appointment.cancel_url }}">Cancelar agendamento</a>{% endif %}
  </div>
</div>
{% endcall %}
{% endblock %}
